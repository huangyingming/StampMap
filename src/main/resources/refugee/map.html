<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8" />
    <title>スタンプマップ</title>
    <script th:inline="javascript">
        /*<![CDATA[*/
        let map;
        let markers = [];
        let infoWindow;
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: {
                    lat: 35.66044 ,
                    lng: 139.381741
                },
                zoom: 10
            });
            addMarkers();
        }
        function addMarkers() {            
            let latlng;
            let i;
            let marker;
            infoWindow = new google.maps.InfoWindow();
            /*[# th:each="place, placeStat : ${placeData}"]*/
                
                latlng = new google.maps.LatLng(
                    /*[[${place.latitude}]]*/,
                    /*[[${place.longitude}]]*/
                );
                i = /*[[${placeStat.index}]]*/;
                console.log(i);
                marker = new google.maps.Marker({
                    position: latlng,
                    map: map,
                    title: /*[[${place.placeName}]]*/
                });
                var imageTag = '';
                /*[+
                if ([[${place.topUrl != null}]]) {
                    imageTag = '<img src=' + [[${place.topUrl}]] +
                ' />'
                }
                +]*/
                
                contentString = '<div class="info-window"><p>' +
                [[${place.description}]] +
                '<p>';
                 +]*/
                contentString += imageTag;
                con
                console.log(/*[[${place.topUrl}]]*/ );
                console.log(contentString);
                google.maps.event.addListener(marker, 'click', (function(marker, contentString, infoWindow) {
                    return function() {
                        infoWindow.setContent(contentString);
                        infoWindow.open(map, marker);
                    };
                })(marker, contentString, infoWindow));
                markers.push(marker);
            /*[/]*/
        }
        /*]]>*/
    </script>
    
    <style>
        #map {
            width: 600px;
            height: 600px;
        }
        img {
            display: block;
        }
        .info-window {
            width: 300px;
            height: 300px;
        }
    </style>
     
</head>
<body>
    <div id="map"></div>
    <img src="http://res.cloudinary.com/foehammer/image/upload/w_250,h_250,c_limit/stamps/rn7fxsilda3wnguum9jl.png" />
    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDNwAXlo4dArvIJa7J9nKGZUUqJfuYtqgg&callback=initMap"> </script>
</body>
</html>
